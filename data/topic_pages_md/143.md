[TON Research](/)

# [Enhancing Network Communication with ADNL: A Deep Dive into TON's Core Protocol](/t/enhancing-network-communication-with-adnl-a-deep-dive-into-tons-core-protocol/143)

[TON Blockchain](/c/ton-blockchain/17) 

    

[ASURADA](https://tonresear.ch/u/ASURADA)   February 3, 2024, 10:55am  1

## [](#abstract-1)Abstract

The Abstract Datagram Network Layer (ADNL) stands as the backbone of the TON (The Open Network), enabling efficient peer-to-peer communication. This technical document delves into ADNL’s design, its core components, and security measures, providing a comprehensive understanding for developers and network architects interested in leveraging this protocol.

## [](#introduction-2)Introduction

ADNL facilitates seamless interaction among network peers through a meticulously designed framework that incorporates cryptographic identity verification, efficient data transmission methods, and robust security protocols. This document outlines ADNL’s operational principles, including peer identity management, cryptographic systems, and the intricacies of its client-server and peer-to-peer (P2P) communication models.

### [](#peer-identity-management-3)Peer Identity Management

In ADNL, each peer is identified by a unique keypair, facilitating secure communications through Diffie-Hellman key exchanges. The identity of a peer is derived from its public key as follows:

Element

Description

address

Generated by SHA-256 hashing of type\_id and public\_key

type\_id

Serialized as little-endian uint32

public\_key

Participant’s public key

This system ensures that each peer can securely identify and communicate with one another without revealing sensitive information.

### [](#cryptographic-systems-4)Cryptographic Systems

ADNL utilizes a specified cryptosystem for its operations, detailed as below:

type\_id (Hexadecimal)

Cryptosystem

Note

0x4813b4c6

ed25519

For x25519 keypairs, conversion to ed25519 is required

These cryptographic measures are integral to maintaining the confidentiality and integrity of the data exchanged over the network.

### [](#client-server-protocol-adnl-over-tcp-5)Client-Server Protocol: ADNL over TCP

ADNL employs a TCP-based handshake mechanism for initiating secure client-server communications. This involves the exchange of abstract addresses, public keys, and encrypted session parameters. The handshake process is detailed in the following table:

Step

Action

Key Agreement

Utilizing x25519 or similar for secret derivation

Session Parameters

Generation and encryption of AES-CTR parameters

Handshake Packet Creation

Assembling and sending encrypted session parameters

### [](#datagram-transmission-6)Datagram Transmission

Following a successful handshake, both parties utilize AES-CTR for secure datagram transmission, ensuring the confidentiality and integrity of the exchanged data. The structure of a transmitted datagram includes a length prefix, nonce, data buffer, and integrity hash, as outlined below:

Element

Size

Description

length

4 bytes (LE)

Excludes length field itself

nonce

32 bytes

Randomly generated value

buffer

Variable (length-64)

Data payload

hash

32 bytes

SHA-256 hash of nonce and buffer for integrity

This framework ensures data integrity and prevents unauthorized manipulation during transmission.

### [](#security-considerations-7)Security Considerations

ADNL incorporates several security measures to protect against potential vulnerabilities, including:

*   **Handshake Padding**: Though its purpose is not explicitly defined, it is speculated to allow future cryptographic flexibility.
*   **Encryption Key Derivation**: Aids in generating unique session keys, enhancing security.
*   **Datagram Nonce**: Prevents bit-flipping attacks and ensures message integrity.

## [](#conclusion-8)Conclusion

ADNL’s architecture offers a robust foundation for building secure, efficient, and scalable network applications. By adhering to the principles outlined in this document, developers can leverage ADNL to enhance communication within the TON ecosystem and beyond.

## [](#references-9)References

This document references the original work and contributions of the TON community and developers, providing a foundation for further exploration and development within the ADNL framework.

![](https://tonresear.ch/uploads/default/original/1X/0ed83f76375108e9d123725ca5aea444729e1f19.png) [docs.ton.org](https://docs.ton.org/learn/networking/low-level-adnl)

![](https://tonresear.ch/uploads/default/optimized/1X/ddc4133dbc9b87c06d71cb329a0d7fb3181c6296_2_690x362.jpeg)

### [Low-Level ADNL | The Open Network](https://docs.ton.org/learn/networking/low-level-adnl)

Abstract Datagram Network Layer (ADNL) is the core protocol of TON, which helps network peers to communicate with each other.

  3 Likes

*   [Home](/)
*   [Categories](/categories)
*   [Guidelines](/guidelines)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled